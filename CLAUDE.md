# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Development Commands

### Core Development

- `pnpm dev` - Start both API server and client development servers concurrently
- `pnpm dev:api` - Start only the Hono API server via Wrangler
- `pnpm dev:client` - Start only the React Router client development server
- `pnpm build` - Build the React Router client application
- `pnpm deploy` - Deploy to Cloudflare Workers with minification

### Code Quality

- `pnpm validate` - Run full validation suite (format, lint, typecheck)
- `pnpm lint` - Run Biome linter
- `pnpm format` - Check code formatting with Prettier
- `pnpm typecheck` - Run TypeScript type checking
- `pnpm typegen` - Generate Cloudflare Worker types

### Database Operations

- `pnpm db:generate` - Generate Drizzle migration files
- `pnpm db:migrate` - Apply migrations to local D1 database
- `pnpm db:migrate:prod` - Apply migrations to production D1 database

### Authentication Schema

- `pnpm auth:generate` - Generate Better Auth schema from migration dummy script

## Architecture Overview

This is a full-stack authentication application built with:

### Backend (Hono + Better Auth + Cloudflare D1)

- **Entry Point**: `src/index.ts` - Main Hono application with CORS configuration
- **Auth Configuration**: `src/lib/auth.config.ts` - Better Auth options (email/password enabled)
- **Auth Instance**: `src/lib/auth.ts` - Better Auth instance with Drizzle adapter for SQLite
- **Database**: `src/db/` - Drizzle ORM setup with auth schema (`schema-auth.ts`) and main schema (`schema.ts`)
- **API Routes**: `src/routes/auth.ts` - Authentication endpoints mounted at `/api`

### Frontend (React Router v7)

- **Configuration**: React Router in SPA mode with prerendering enabled
- **Auth Client**: `app/lib/auth-client.ts` - Better Auth React client
- **Routes**: `app/routes/` - File-based routing with home page
- **Styling**: Tailwind CSS v4 integrated

### Database Schema

- Uses Drizzle ORM with SQLite (Cloudflare D1)
- Auth tables generated by Better Auth (user, session, account, verification)
- Schema split between `schema-auth.ts` (auth tables) and `schema.ts` (app tables)

### Key Integration Points

- Hono app uses `AuthType` variables for type-safe auth context
- CORS configured for local development (localhost:5173)
- Cloudflare D1 database binding named "DB" in wrangler.jsonc
- Better Auth uses Drizzle adapter for database operations

### Environment Setup

- Uses pnpm workspace configuration
- Cloudflare Workers with Node.js compatibility flags
- TypeScript configuration split for different environments (cloudflare, node)
