# Hono Better Auth D1

ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯èªè¨¼ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ - Hono + Better Auth + Cloudflare D1 + React Router + shadcn/ui

## ğŸš€ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- **[Hono](https://hono.dev/)** - è»½é‡ã§é«˜é€ŸãªWebãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **[Better Auth](https://www.better-auth.com/)** - ãƒ¢ãƒ€ãƒ³ãªèªè¨¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- **[Cloudflare D1](https://developers.cloudflare.com/d1/)** - SQLiteãƒ™ãƒ¼ã‚¹ã®ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- **[Drizzle ORM](https://orm.drizzle.team/)** - TypeScript ORMã¨ã‚¹ã‚­ãƒ¼ãƒãƒ“ãƒ«ãƒ€ãƒ¼

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- **[React Router v7](https://reactrouter.com/)** - SPAãƒ¢ãƒ¼ãƒ‰ï¼ˆ`ssr: false`ï¼‰ã§ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- **[Tailwind CSS v4](https://tailwindcss.com/)** - ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆCSSãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **[shadcn/ui](https://ui.shadcn.com/)** - ç¾ã—ãå†åˆ©ç”¨å¯èƒ½ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### é–‹ç™ºãƒ„ãƒ¼ãƒ«
- **TypeScript** - å‹å®‰å…¨æ€§
- **Biome** - é«˜é€Ÿãªãƒªãƒ³ã‚¿ãƒ¼ãƒ»ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼
- **Prettier** - ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼
- **pnpm** - é«˜é€Ÿãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼

## âœ¨ æ©Ÿèƒ½

- âœ… ãƒ¡ãƒ¼ãƒ«ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼
- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ï¼ˆã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ï¼‰
- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆã‚µã‚¤ãƒ³ã‚¤ãƒ³ï¼‰
- âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- âœ… ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãªUI/UX
- âœ… ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- âœ… ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹è¡¨ç¤º

## ğŸ› ï¸ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶

- Node.js 18+
- pnpm
- Cloudflareã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤ç”¨ï¼‰

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone <repository-url>
cd hono-better-auth-d1

# ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pnpm install
```

### ç’°å¢ƒè¨­å®š

```bash
# D1ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆï¼ˆãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ï¼‰
pnpm db:generate
pnpm db:migrate
```

### é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•

```bash
# APIã‚µãƒ¼ãƒãƒ¼ã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’åŒæ™‚èµ·å‹•
pnpm dev

# ã¾ãŸã¯å€‹åˆ¥ã«èµ·å‹•
pnpm dev:api    # Honoãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆWranglerï¼‰
pnpm dev:client # React Routerãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
```

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
â”œâ”€â”€ api/                    # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆHonoï¼‰
â”‚   â”œâ”€â”€ index.ts           # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ auth.config.ts # Better Authè¨­å®š
â”‚   â”‚   â””â”€â”€ auth.ts        # èªè¨¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ index.ts       # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š
â”‚   â”‚   â”œâ”€â”€ schema.ts      # ãƒ¡ã‚¤ãƒ³ã‚¹ã‚­ãƒ¼ãƒ
â”‚   â”‚   â””â”€â”€ schema-auth.ts # èªè¨¼ã‚¹ã‚­ãƒ¼ãƒ
â”‚   â””â”€â”€ routes/
â”‚       â””â”€â”€ auth.ts        # èªè¨¼API ãƒ«ãƒ¼ãƒˆ
â”œâ”€â”€ app/                   # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆReact Router v7 SPAï¼‰
â”‚   â”œâ”€â”€ components/        # UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ ui/           # shadcn/ui ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ signin-form.tsx
â”‚   â”‚   â”œâ”€â”€ signup-form.tsx
â”‚   â”‚   â””â”€â”€ dashboard.tsx
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â””â”€â”€ use-session.ts # ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãƒ•ãƒƒã‚¯
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ auth-client.ts # Better Auth ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚   â””â”€â”€ utils.ts       # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
â”‚   â”œâ”€â”€ routes/           # ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
â”‚   â”‚   â”œâ”€â”€ _index/       # ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸
â”‚   â”‚   â””â”€â”€ signup/       # ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ root.tsx          # ãƒ«ãƒ¼ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ routes.ts         # ãƒ«ãƒ¼ãƒˆå®šç¾©
â”‚   â””â”€â”€ app.css           # ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚¿ã‚¤ãƒ«
â”œâ”€â”€ migrations/            # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ scripts/              # ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ public/               # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ react-router.config.ts # React Routerè¨­å®šï¼ˆSPAãƒ¢ãƒ¼ãƒ‰ï¼‰
â”œâ”€â”€ components.json       # shadcn/uiè¨­å®š
â”œâ”€â”€ drizzle.config.ts     # Drizzle ORMè¨­å®š
â””â”€â”€ wrangler.jsonc        # Cloudflare Workersè¨­å®š
```

## ğŸ”§ åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰

### é–‹ç™º
```bash
pnpm dev                   # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆãƒ»ãƒãƒƒã‚¯åŒæ™‚ï¼‰
pnpm dev:api              # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã¿èµ·å‹•
pnpm dev:client           # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã¿èµ·å‹•
pnpm build                # ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
```bash
pnpm db:generate          # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ
pnpm db:migrate           # ãƒ­ãƒ¼ã‚«ãƒ«DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
pnpm db:migrate:prod      # æœ¬ç•ªDBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
pnpm auth:generate        # Better Auth ã‚¹ã‚­ãƒ¼ãƒç”Ÿæˆ
```

### ã‚³ãƒ¼ãƒ‰å“è³ª
```bash
pnpm validate             # å…¨ä½“æ¤œè¨¼ï¼ˆãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒ»ãƒªãƒ³ãƒˆãƒ»å‹ãƒã‚§ãƒƒã‚¯ï¼‰
pnpm lint                 # Biome ãƒªãƒ³ãƒˆå®Ÿè¡Œ
pnpm format               # Prettier ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒã‚§ãƒƒã‚¯
pnpm typecheck            # TypeScript å‹ãƒã‚§ãƒƒã‚¯
```

### ãƒ‡ãƒ—ãƒ­ã‚¤
```bash
pnpm deploy               # Cloudflare Workers ã«ãƒ‡ãƒ—ãƒ­ã‚¤
pnpm typegen              # Cloudflare Workers å‹ç”Ÿæˆ
```

## ğŸŒ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

èªè¨¼APIã¯ `/api` ä¸‹ã«ãƒã‚¦ãƒ³ãƒˆã•ã‚Œã¦ã„ã¾ã™ï¼š

- `POST /api/sign-up` - ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²
- `POST /api/sign-in` - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³
- `POST /api/sign-out` - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
- `GET /api/session` - ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±å–å¾—

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤

### Cloudflare Workers & D1

1. Cloudflareã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ï¼š
```bash
npx wrangler login
```

2. D1ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆï¼š
```bash
npx wrangler d1 create hono-better-auth-db
```

3. `wrangler.jsonc` ã‚’æ›´æ–°ã—ã¦ã€ä½œæˆã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹IDã‚’è¨­å®š

4. æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œï¼š
```bash
pnpm db:migrate:prod
```

5. ãƒ‡ãƒ—ãƒ­ã‚¤ï¼š
```bash
pnpm deploy
```

## âš™ï¸ React Router v7 SPA è¨­å®š

`react-router.config.ts`:
```typescript
export default {
  ssr: false,      // SPAãƒ¢ãƒ¼ãƒ‰æœ‰åŠ¹
  prerender: true, // ãƒ—ãƒªãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æœ‰åŠ¹
} satisfies Config
```

SPAãƒ¢ãƒ¼ãƒ‰ã«ã‚ˆã‚Šï¼š
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- é«˜é€Ÿãªãƒšãƒ¼ã‚¸é·ç§»
- ãƒ“ãƒ«ãƒ‰æ™‚ãƒ—ãƒªãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°

## ğŸ¨ UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ [shadcn/ui](https://ui.shadcn.com/) ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚æ–°ã—ã„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¿½åŠ ã™ã‚‹å ´åˆï¼š

```bash
pnpm dlx shadcn@latest add button
pnpm dlx shadcn@latest add input
# ãªã©...
```

## ğŸ” èªè¨¼ãƒ•ãƒ­ãƒ¼

1. **ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—**: `/signup` ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼åã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›
2. **ã‚µã‚¤ãƒ³ã‚¤ãƒ³**: ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã§ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›
3. **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†**: ã‚µã‚¤ãƒ³ã‚¤ãƒ³å¾Œã¯ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãŒè¡¨ç¤º
4. **ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆ**: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆå¯èƒ½

## ğŸ“ é–‹ç™ºãƒãƒ¼ãƒˆ

- **React Router v7**: SPAãƒ¢ãƒ¼ãƒ‰ï¼ˆ`ssr: false`ï¼‰ã§ãƒ—ãƒªãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æœ‰åŠ¹
- **TypeScriptè¨­å®š**: ãƒ¢ãƒãƒ¬ãƒæ§‹æˆã§ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§åˆ†é›¢
- **Better Auth**: email/passwordèªè¨¼ã®ã¿æœ‰åŠ¹åŒ–
- **CORSè¨­å®š**: ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒï¼ˆlocalhost:5173ï¼‰ã«å¯¾å¿œ
- **ãƒ•ã‚©ãƒ¼ãƒ å®Ÿè£…**: FormDataãƒ™ãƒ¼ã‚¹ã§å®Ÿè£…ï¼ˆReactçŠ¶æ…‹ç®¡ç†ãªã—ï¼‰

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

1. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ•ã‚©ãƒ¼ã‚¯
2. æ©Ÿèƒ½ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ (`git checkout -b feature/amazing-feature`)
3. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ (`git commit -m 'Add amazing feature'`)
4. ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ (`git push origin feature/amazing-feature`)
5. ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆ

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚